# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞–≥—Ä—É–∑–∫–∏

**–î–∞—Ç–∞:** 03.10.2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è >10 —Å–µ–∫—É–Ω–¥

---

## üéØ –¶–µ–ª—å

–ù–∞–π—Ç–∏ —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É –º–µ–¥–ª–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å.

---

## üìã –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å RLS

### 1.1 –í—ã–ø–æ–ª–Ω–∏ SQL –≤ Supabase:

https://supabase.com/dashboard/project/ewkeuupfristqqonkcph/sql/new

```sql
SELECT tablename, rowsecurity 
FROM pg_tables 
WHERE tablename = 'profiles';
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
tablename | rowsecurity
----------|------------
profiles  | false
```

–ï—Å–ª–∏ `rowsecurity = true` - RLS –≤—Å—ë –µ—â–µ –≤–∫–ª—é—á–µ–Ω, –Ω—É–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å:
```sql
ALTER TABLE profiles DISABLE ROW LEVEL SECURITY;
```

---

## üìã –®–∞–≥ 2: –¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 2.1 –û—Ç–∫—Ä–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—É:

```
http://localhost:3001/debug
```

### 2.2 –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫–∏ –ø–æ –ø–æ—Ä—è–¥–∫—É:

1. **"1. –¢–µ—Å—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î"**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –≤–æ–æ–±—â–µ Supabase
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å <500ms

2. **"2. –¢–µ—Å—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç auth.getSession()
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å <500ms

3. **"3. –¢–µ—Å—Ç –∑–∞–ø—Ä–æ—Å–∞ profiles"**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç SELECT * FROM profiles LIMIT 1
   - **–¢—É—Ç –∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ –µ—Å–ª–∏ >2000ms**

### 2.3 –°–º–æ—Ç—Ä–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

**–•–æ—Ä–æ—à–æ (–∑–µ–ª–µ–Ω—ã–π):** <500ms ‚úÖ  
**–ú–µ–¥–ª–µ–Ω–Ω–æ (–∂–µ–ª—Ç—ã–π):** 500-2000ms ‚ö†Ô∏è  
**–ö—Ä–∏—Ç–∏—á–Ω–æ (–∫—Ä–∞—Å–Ω—ã–π):** >2000ms üî¥  

---

## üìã –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å Supabase Dashboard

### 3.1 –û—Ç–∫—Ä–æ–π Logs:

https://supabase.com/dashboard/project/ewkeuupfristqqonkcph/logs/postgres-logs

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (slow queries)
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –¢–∞–π–º–∞—É—Ç—ã

### 3.2 –û—Ç–∫—Ä–æ–π Performance:

https://supabase.com/dashboard/project/ewkeuupfristqqonkcph/reports/database

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- Query performance (—Å–∞–º—ã–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- Active connections (–Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω—ã –ª–∏?)
- Database load (–Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î)

---

## üìã –®–∞–≥ 4: Network –∞–Ω–∞–ª–∏–∑

### 4.1 –û—Ç–∫—Ä–æ–π DevTools (F12) ‚Üí Network

### 4.2 –û–±–Ω–æ–≤–∏ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–¥–º–∏–Ω–∫–∏

### 4.3 –ù–∞–π–¥–∏ –∑–∞–ø—Ä–æ—Å—ã –∫ Supabase:

–ò—â–∏ –∑–∞–ø—Ä–æ—Å—ã –∫ `*.supabase.co`

**–°–º–æ—Ç—Ä–∏:**
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ (Time)
- –°—Ç–∞—Ç—É—Å (Status)
- –†–∞–∑–º–µ—Ä (Size)

**–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å—ã –≤–∏—Å—è—Ç >10s:**
- –ü—Ä–æ–±–ª–µ–º–∞ —Å —Å–µ—Ç—å—é –∏–ª–∏ Supabase
- –í–æ–∑–º–æ–∂–Ω–æ rate limiting
- –í–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã —Å RLS

---

## üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–∏—á–∏–Ω–∞ #1: RLS –ø–æ–ª–∏—Ç–∏–∫–∏ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–µ

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü–æ—Å–ª–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è RLS –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ policy –ø—Ä–æ–≤–µ—Ä–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ–º RLS –Ω–∞ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
ALTER TABLE profiles DISABLE ROW LEVEL SECURITY;
ALTER TABLE brands DISABLE ROW LEVEL SECURITY;
ALTER TABLE spas DISABLE ROW LEVEL SECURITY;
ALTER TABLE leads DISABLE ROW LEVEL SECURITY;

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å
-- –ï—Å–ª–∏ —Å—Ç–∞–ª–æ –±—ã—Å—Ç—Ä–æ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ RLS
-- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –ø—Ä–æ—â–µ
```

---

### –ü—Ä–∏—á–∏–Ω–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ó–∞–ø—Ä–æ—Å—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–∞–∂–µ –±–µ–∑ RLS
- –í EXPLAIN –≤–∏–¥–Ω–æ Sequential Scan

**–†–µ—à–µ–Ω–∏–µ:**
```sql
-- –£–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –≤ migrations/add-performance-indexes.sql
-- –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –º–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞:
SELECT * FROM pg_indexes WHERE schemaname = 'public';
```

---

### –ü—Ä–∏—á–∏–Ω–∞ #3: –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ç—å—é –¥–æ Supabase

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –º–µ–¥–ª–µ–Ω–Ω—ã–µ
- Ping –¥–æ Supabase >200ms

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
ping ewkeuupfristqqonkcph.supabase.co

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å <100ms
```

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥—É—é —Å–µ—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å VPN
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall

---

### –ü—Ä–∏—á–∏–Ω–∞ #4: Free tier –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Supabase

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ú–µ–¥–ª–µ–Ω–Ω–æ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
- –í Dashboard –≤–∏–¥–Ω–æ Rate Limiting

**–†–µ—à–µ–Ω–∏–µ:**
- –ê–ø–≥—Ä–µ–π–¥ –Ω–∞ –ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- –ò–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤

---

### –ü—Ä–∏—á–∏–Ω–∞ #5: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í Network –≤–∏–¥–Ω–æ 5-10 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- React –¥–µ–ª–∞–µ—Ç useEffect –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑

**–†–µ—à–µ–Ω–∏–µ:**
- –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ AuthContext (–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–µ—Ç –ª–∏ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç —Å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

## üìä –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –æ—Ç—á–µ—Ç–∞

–ü–æ—Å–ª–µ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ —Å–æ–±–µ—Ä–∏:

1. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã /debug:**
   - –°–∫—Ä–∏–Ω—à–æ—Ç —Å –≤—Ä–µ–º–µ–Ω–µ–º –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
   - –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–µ–Ω —Ç–µ—Å—Ç #3 (profiles)

2. **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã SQL –ø—Ä–æ–≤–µ—Ä–æ–∫:**
   - –°—Ç–∞—Ç—É—Å RLS (–≤–∫–ª—é—á–µ–Ω/–≤—ã–∫–ª—é—á–µ–Ω)
   - –ù–∞–ª–∏—á–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

3. **Network timing:**
   - –°–∫—Ä–∏–Ω—à–æ—Ç –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –í—Ä–µ–º—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

4. **Supabase Dashboard:**
   - Query performance
   - Slow queries
   - Errors

5. **–û–∫—Ä—É–∂–µ–Ω–∏–µ:**
   - –ò–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä
   - –ò—Å–ø–æ–ª—å–∑—É–µ—à—å –ª–∏ VPN
   - –ë—Ä–∞—É–∑–µ—Ä –∏ –≤–µ—Ä—Å–∏—è

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

### –ï—Å–ª–∏ /debug –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç <500ms –Ω–∞ –≤—Å–µ —Ç–µ—Å—Ç—ã:
‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –ë–î/—Å–µ—Ç–∏**
- –ü—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –°–º–æ—Ç—Ä–µ—Ç—å AuthContext
- –°–º–æ—Ç—Ä–µ—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–Ω–¥–µ—Ä—ã

### –ï—Å–ª–∏ /debug –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç >2000ms –Ω–∞ —Ç–µ—Å—Ç #3:
üî¥ **–ü—Ä–æ–±–ª–µ–º–∞ –≤ –∑–∞–ø—Ä–æ—Å–µ profiles**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å

### –ï—Å–ª–∏ /debug –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç >2000ms –Ω–∞ —Ç–µ—Å—Ç #1:
üî¥ **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ Supabase**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç—å
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Supabase status
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –¥—Ä—É–≥—É—é —Å–µ—Ç—å

---

## üí° –ë—ã—Å—Ç—Ä—ã–µ workarounds

### Workaround #1: –û—Ç–∫–ª—é—á–∏—Ç—å RLS –≤–µ–∑–¥–µ

```sql
DO $$ 
DECLARE 
    r RECORD;
BEGIN
    FOR r IN SELECT tablename FROM pg_tables WHERE schemaname = 'public'
    LOOP
        EXECUTE 'ALTER TABLE ' || quote_ident(r.tablename) || ' DISABLE ROW LEVEL SECURITY';
    END LOOP;
END $$;
```

‚ö†Ô∏è **–¢–æ–ª—å–∫–æ –¥–ª—è development! –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ production!**

### Workaround #2: –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

–£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ AuthContext —á–µ—Ä–µ–∑ `profileCache`.

### Workaround #3: Lazy loading

–ó–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é, –∞ –Ω–µ –≤—Å–µ —Å—Ä–∞–∑—É.

---

## üìû –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. –ü—Ä–æ–≤–µ—Ä—å https://status.supabase.com - –º–æ–∂–µ—Ç Supabase down
2. –ü–æ–ø—Ä–æ–±—É–π —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Supabase –ø—Ä–æ–µ–∫—Ç –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–º
3. –û–±—Ä–∞—Ç–∏—Å—å –≤ Supabase Support —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

*–°–æ–∑–¥–∞–Ω–æ: 03.10.2025*
